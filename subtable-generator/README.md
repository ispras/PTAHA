# Генератор подтаблиц с информацией о патентах
## Входные данные
Программа принимает на вход таблицу (в формате xls/xlsx или csv) с данными о патентах, содержащую следующие столбцы:

- **№**
- **Читал**
- **Страна выдачи**
- **Вид патента**
- **Номер патента**
- **Full ID**
- **Link**
- **Классификационный индекс (IPC)**
- **Классификатор(ы) (CPC)**
- **Предмет поиска**
- **Заявитель**
- **Страна заявитель**
- **Изобретатель**
- **Номер заявки**
- **Дата приоритета**
- **Приоритетные документы**
- **Дата подачи заявки**
- **Год подачи заявки**
- **Дата публикации**
- **Год публикации**
- **Название**
- **Сведения о действии**
- **Tag**
- столбцы с идентификаторами стран

### Требования к таблице, подаваемой на вход:
Таблица должна быть представлена в одном из 2-х допустимых форматов: xlsx, csv.
Названия столбцов, выделенные жирным шрифтом, непосредственно используются программой для обработки данных, поэтому **таблица, подаваемая на вход, должна содержать столбцы с точно такими же названиями**. Другие названия столбцов (учитывая регистр и пробелы) будут приводить к ошибкам в ходе исполнения программы.
Столбцы с идентификаторами стран именуются по ВОИС ST.3, их количество является произвольным натуральным числом.
***
## Выходные данные
Программа генерирует 4 таблицы:
1. Таблица В.6.1 - Патентная документация 
2. Tаблица В.6.4 - Количество опубликованных охранных документов по годам (изобретательская активность)
3. Таблица В.6.5 - Взаимное патентование
4. Tаблица В.6.6 - География патентования объектов промышленной собственности исследуемыми фирмами (по патентам-аналогам)

Формат выходных данных задаётся пользователем на этапе запуска скрипта. Допускается выбор одного из 2-х допустимых форматов выходных данных: xlsx, csv. В случае, если пользователь не указал формат выходных данных, выходные данные генерируются в формате входных данных по умолчанию.

## Запуск скрипта из консоли
Для запуска следует "вызвать" скрипт, передав ему в качестве параметров:
1. Путь к входному файлу. Обязательный параметр.
2. Формат выходных данных, используя флаг --outformat (-of). Необязательный параметр. Если его не передать, выходные данные будут в таком же формате, как входные.

Пример: 
```console
tablegen.py "<insert your path to the file>" -of xlsx
```
В случае успешного завершения работы, в консоли вновь появится рабочий каталог пользователя.

### Ошибка 1: Пользователь ввел некорректный путь к исходному файлу: 
Если пользователь передал неверный путь к файлу с входными данными, будет выведена ошибка:
```console
FileNotFoundError: [Errno 2] No such file or directory: '<given path to the input-file>'
```
### Ошибка 2: Пользователь не передал путь к исходному файлу: 
Если пользователь не передал путь к файлу с входными данными, будет выведено сообщение:
```console
usage: tablegen.py [-h] [-of OUTFORMAT] pathtofile
tablegen.py: error: the following arguments are required: pathtofile
```
### Ошибка 3: Входной и/или выходной формат данных не поддерживается: 
Если пользователь передал на вход данные в недопустимом формате, либо указал недопустимый формат выходных данных, будет выведена ошибка:
```console
Script works with only xlsx,csv and ods formats
```
### Ошибка 4: в таблице со входными данными некорректно назван(ы) столбец(цы): 
Для корректной работы скрипта, все столбцы таблицы входных данных должны иметь заданные выше названия. Лишние пробелы, несоответсвующие регистры букв в названиях столбцов также приведут к ошибке:
```console
KeyError: '<incorrect name of the column>'
```
